# –ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–æ —É–ø—Ä–∞–∂–Ω–µ–Ω–∏–µ ‚Äì Generics –∏ Traits II

## üéØ –¶–µ–ª–∏
- –î–∞ –ø—Ä–µ–≥–æ–≤–æ—Ä–∏–º –∏ –∑–∞–¥—ä–ª–±–æ—á–∏–º —Ä–∞–∑–±–∏—Ä–∞–Ω–µ—Ç–æ –Ω–∞ generics, traits, –∞—Å–æ—Ü–∏–∏—Ä–∞–Ω–∏ —Ç–∏–ø–æ–≤–µ, trait bounds, trait objects –∏ –¥—Ä.  
- –î–∞ –æ—Ç–≥–æ–≤–æ—Ä–∏–º –Ω–∞ –∫–ª—é—á–æ–≤–∏ –≤—ä–ø—Ä–æ—Å–∏ –∏ —Å–∏—Ç—É–∞—Ü–∏–∏, —Å–≤—ä—Ä–∑–∞–Ω–∏ —Å —Ç–µ–º–∞—Ç–∞ –Ω–∞ –ª–µ–∫—Ü–∏—è—Ç–∞.  
- –î–∞ —Ä–∞–∑–≤–∏–µ–º –Ω–∞–≤–∏–∫ –¥–∞ –∞—Ä–≥—É–º–µ–Ω—Ç–∏—Ä–∞–º–µ —Ä–µ—à–µ–Ω–∏—è—Ç–∞ —Å–∏ –≤ Rust.

---

## ‚ùì –í—ä–ø—Ä–æ—Å–∏ –∑–∞ —Å–∞–º–æ–ø—Ä–æ–≤–µ—Ä–∫–∞

1. **–ö–∞–∫–≤–∞ –µ —Ä–∞–∑–ª–∏–∫–∞—Ç–∞ –º–µ–∂–¥—É generics –∏ –∞—Å–æ—Ü–∏–∏—Ä–∞–Ω —Ç–∏–ø** –≤ trait (–Ω–∞–ø—Ä. `fn foo<T>(...)` —Å—Ä–µ—â—É `type Item;`) –ø—Ä–∏ –¥–µ—Ñ–∏–Ω–∏—Ä–∞–Ω–µ –Ω–∞ trait?  

<details>
<summary>–ù–∞—Ç–∏—Å–Ω–∏, –∑–∞ –¥–∞ –ø–æ–∫–∞–∂–µ—à –æ—Ç–≥–æ–≤–æ—Ä–∞</summary>

 - Generics: —Ç–∏–ø—ä—Ç —Å–µ –ø–æ–¥–∞–≤–∞ –ø—Ä–∏ –∏–∑–≤–∏–∫–≤–∞–Ω–µ (fn foo<T>(x: T) ‚Üí –≤—Å–µ–∫–∏ T).
 - Associated Type: —Ç–∏–ø—ä—Ç —Å–µ –¥–µ—Ñ–∏–Ω–∏—Ä–∞ –≤—ä—Ç—Ä–µ –≤ trait –∏ —Å–µ —Ñ–∏–∫—Å–∏—Ä–∞ –ø—Ä–∏ –∏–º–ø–ª–µ–º–µ–Ω—Ç–∞—Ü–∏—è—Ç–∞ (type Item;).
 - –ü–æ–ª–∑–≤–∞—Ç —Å–µ, –∫–æ–≥–∞—Ç–æ trait –∏–º–∞ —Ç–æ—á–Ω–æ –µ–¥–∏–Ω –ª–æ–≥–∏—á–µ—Å–∫–∏ ‚Äû–∏–∑—Ö–æ–¥–µ–Ω‚Äú —Ç–∏–ø (–ø—Ä–∏–º–µ—Ä: Iterator::Item)

</details>


2. **–ö–∞–∫–≤–æ –æ–∑–Ω–∞—á–∞–≤–∞ ‚Äútrait bound‚Äù** –∏ –∫–∞–∫ —Å–µ –∏–∑–ø–æ–ª–∑–≤–∞ –≤ –¥–µ—Ñ–∏–Ω–∏—Ü–∏—è –∫–∞—Ç–æ:  
   ```rust
   fn convert_to_json<T: ToJson>(x: T) -> String
   ```  

<details>
<summary>–ù–∞—Ç–∏—Å–Ω–∏, –∑–∞ –¥–∞ –ø–æ–∫–∞–∂–µ—à –æ—Ç–≥–æ–≤–æ—Ä–∞</summary>

 - –û–≥—Ä–∞–Ω–∏—á–∞–≤–∞—Ç generic —Ç–∏–ø–∞: T: ToJson ‚Üí ‚ÄûT —Ç—Ä—è–±–≤–∞ –¥–∞ –∏–º–ø–ª–µ–º–µ–Ω—Ç–∏—Ä–∞ ToJson‚Äú.
 - –¢–∞–∫–∞ –º–æ–∂–µ–º –¥–∞ –∏–∑–≤–∏–∫–≤–∞–º–µ –º–µ—Ç–æ–¥–∏ –Ω–∞ ToJson –≤—ä—Ä—Ö—É x.
 - –ü—Ä–∏–º–µ—Ä:
  ```rust
  fn foo<T: Trait>(x: T) {}
  // –∏–ª–∏
  fn foo<T>(x: T) where T: Trait {}
  ```

</details>

3. **–ó–∞—â–æ trait —Å –∞—Å–æ—Ü–∏–∏—Ä–∞–Ω —Ç–∏–ø —á–µ—Å—Ç–æ –Ω–µ –º–æ–∂–µ –¥–∞ –±—ä–¥–µ –∏–∑–ø–æ–ª–∑–≤–∞–Ω –∫–∞—Ç–æ trait object** (–Ω–∞–ø—Ä. `&dyn Iterator`) –±–µ–∑ –¥–æ–ø—ä–ª–Ω–∏—Ç–µ–ª–Ω–æ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ? –î–∞–π –ø—Ä–∏–º–µ—Ä.  


<details>
<summary>–ù–∞—Ç–∏—Å–Ω–∏, –∑–∞ –¥–∞ –ø–æ–∫–∞–∂–µ—à –æ—Ç–≥–æ–≤–æ—Ä–∞</summary>

 - dyn Trait –∏–∑–∏—Å–∫–≤–∞ trait-—ä—Ç –¥–∞ –µ object safe.
 - –ê–∫–æ trait –∏–º–∞ –∞—Å–æ—Ü–∏–∏—Ä–∞–Ω —Ç–∏–ø, —Ç—Ä—è–±–≤–∞ –¥–∞ –≥–æ —Ñ–∏–∫—Å–∏—Ä–∞–º–µ:
  
   - &mut dyn Iterator<Item = i32> // –æ–∫
   - &mut dyn Iterator // ‚ùå –Ω–µ–∏–∑–≤–µ—Å—Ç–µ–Ω Item

</details>

4. **–ö–∞–∫–≤–æ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–≤–∞ `?Sized`** –∏ –∫–æ–≥–∞ –µ –Ω—É–∂–Ω–æ –¥–∞ –≥–æ –∏–∑–ø–æ–ª–∑–≤–∞–º–µ?  

<details>
<summary>–ù–∞—Ç–∏—Å–Ω–∏, –∑–∞ –¥–∞ –ø–æ–∫–∞–∂–µ—à –æ—Ç–≥–æ–≤–æ—Ä–∞</summary>

 - –ü–æ–∑–≤–æ–ª—è–≤–∞ —Ç–∏–ø—ä—Ç –¥–∞ –Ω—è–º–∞ —Ñ–∏–∫—Å–∏—Ä–∞–Ω —Ä–∞–∑–º–µ—Ä.
 - –ù—É–∂–Ω–æ –µ –ø—Ä–∏ —Ç–∏–ø–æ–≤–µ –∫–∞—Ç–æ dyn Trait –∏ [T].
 ```rust
  fn foo<T: ?Sized>(x: &T) {}
 ```
 - –¢–∞–∫–∞ –º–æ–∂–µ–º –¥–∞ –ø—Ä–∏–µ–º–µ–º –∏ –¥–∏–Ω–∞–º–∏—á–Ω–∏ —Ç–∏–ø–æ–≤–µ —á—Ä–µ–∑ —Ä–µ—Ñ–µ—Ä–µ–Ω—Ü–∏–∏.

</details>

5. –ö–∞–∫ –¥–µ—Ñ–∏–Ω–∏—Ü–∏—è—Ç–∞ –Ω–∞  
   ```rust
   trait Aggregate {
       type Output;
       fn aggregate(data: &[Self]) -> Self::Output;
   }
   ```  
   –∏ –¥–æ–±–∞–≤—è–Ω–µ—Ç–æ –Ω–∞ `where Self: Sized` –≤–ª–∏—è—è—Ç –≤—ä—Ä—Ö—É —Ç–æ–≤–∞ –¥–∞–ª–∏ –º–æ–∂–µ –¥–∞ —Å–µ –∏–∑–ø–æ–ª–∑–≤–∞ trait object?  

<details>
<summary>–ù–∞—Ç–∏—Å–Ω–∏, –∑–∞ –¥–∞ –ø–æ–∫–∞–∂–µ—à –æ—Ç–≥–æ–≤–æ—Ä–∞</summary>

 - –ö–∞–∑–≤–∞, —á–µ trait –º–æ–∂–µ –¥–∞ —Å–µ –∏–º–ø–ª–µ–º–µ–Ω—Ç–∏—Ä–∞ —Å–∞–º–æ –∑–∞ —Ç–∏–ø–æ–≤–µ —Å –∏–∑–≤–µ—Å—Ç–µ–Ω —Ä–∞–∑–º–µ—Ä.
 - –¢–æ–≤–∞ –ø—Ä–∞–≤–∏ trait-–∞ –Ω–µ–∏–∑–ø–æ–ª–∑–≤–∞–µ–º –∫–∞—Ç–æ trait object (dyn Trait)

</details>

6. **–ö–∞–∫–≤–æ –µ ‚Äúdereference coercion‚Äù** (`Deref` –∏ `DerefMut`) –∏ –∫–æ–≥–∞ –∫–æ–º–ø–∏–ª–∞—Ç–æ—Ä—ä—Ç –≥–æ –ø—Ä–∏–ª–∞–≥–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ (–ø—Ä–∏–º–µ—Ä: `&Box<T>` ‚Üí `&T`)?  

<details>
<summary>–ù–∞—Ç–∏—Å–Ω–∏, –∑–∞ –¥–∞ –ø–æ–∫–∞–∂–µ—à –æ—Ç–≥–æ–≤–æ—Ä–∞</summary>

 - –ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ –ø—Ä–µ–æ–±—Ä–∞–∑—É–≤–∞–Ω–µ —á—Ä–µ–∑ Deref/DerefMut.
 ```rust
  fn takes_str(s: &str) {}
  let b = Box::new(String::from("hi"));
  takes_str(&b); // Box<String> ‚Üí String ‚Üí &str
 ```

</details>

7. **–ó–∞—â–æ –æ–ø–µ—Ä–∞—Ç–æ—Ä–∏—Ç–µ –≤ Rust (–∫–∞—Ç–æ `+`, `*`) —Å–µ –¥–µ—Ñ–∏–Ω–∏—Ä–∞—Ç —á—Ä–µ–∑ traits —Å –∞—Å–æ—Ü–∏–∏—Ä–∞–Ω–∏ —Ç–∏–ø–æ–≤–µ**, –∞ –Ω–µ —á—Ä–µ–∑ traits —Å generic –ø–∞—Ä–∞–º–µ—Ç—Ä–∏ –∑–∞ —Ä–µ–∑—É–ª—Ç–∞—Ç–∞?  

<details>
<summary>–ù–∞—Ç–∏—Å–Ω–∏, –∑–∞ –¥–∞ –ø–æ–∫–∞–∂–µ—à –æ—Ç–≥–æ–≤–æ—Ä–∞</summary>

 - –ü—Ä–∏–º–µ—Ä:
```rust
  trait Add<RHS = Self> { type Output; }
```
 - Output –µ –∞—Å–æ—Ü–∏–∏—Ä–∞–Ω —Ç–∏–ø ‚Üí –ø–æ-—è—Å–Ω–æ –∏ —É–¥–æ–±–Ω–æ, –æ—Ç–∫–æ–ª–∫–æ—Ç–æ generic –ø–∞—Ä–∞–º–µ—Ç—ä—Ä –∑–∞ —Ä–µ–∑—É–ª—Ç–∞—Ç–∞

</details>

8. **–ö–æ–≥–∞ –µ –ø–æ-–ø–æ–¥—Ö–æ–¥—è—â–æ –¥–∞ –∏–∑–ø–æ–ª–∑–≤–∞–º–µ trait object** (–Ω–∞–ø—Ä–∏–º–µ—Ä `Box<dyn Trait>`) –≤–º–µ—Å—Ç–æ generic —Ç–∏–ø –ø–∞—Ä–∞–º–µ—Ç—ä—Ä? –ö–∞–∫–≤–∏ —Å–∞ –∫–æ–º–ø—Ä–æ–º–∏—Å–∏—Ç–µ –º–µ–∂–¥—É –¥–≤–∞—Ç–∞ –ø–æ–¥—Ö–æ–¥–∞?   

<details>
<summary>–ù–∞—Ç–∏—Å–Ω–∏, –∑–∞ –¥–∞ –ø–æ–∫–∞–∂–µ—à –æ—Ç–≥–æ–≤–æ—Ä–∞</summary>

 - Generic (T: Trait) ‚Üí compile-time, –ø–æ-–±—ä—Ä–∑–æ, –Ω–æ —Ñ–∏–∫—Å–∏—Ä–∞–Ω–æ.
 - Trait object (Box<dyn Trait>) ‚Üí runtime, –≥—ä–≤–∫–∞–≤–æ, –Ω–æ –º–∞–ª–∫–æ –ø–æ-–±–∞–≤–Ω–æ.
 - –ò–∑–ø–æ–ª–∑–≤–∞–π dyn Trait, –∫–æ–≥–∞—Ç–æ —Ç–∏–ø—ä—Ç —Å–µ —Ä–µ—à–∞–≤–∞ –ø–æ –≤—Ä–µ–º–µ –Ω–∞ –∏–∑–ø—ä–ª–Ω–µ–Ω–∏–µ.

</details>

9. –î–∞–¥–µ–Ω–æ –µ:  
    ```rust
    trait MyTrait {
        type Output;
        fn do_stuff(&self) -> Self::Output;
    }
    struct Foo;
    impl MyTrait for Foo {
        type Output = String;
        fn do_stuff(&self) -> String { "hello".to_string() }
    }
    ```
    –ö–∞–∫ –±–∏—Ö–º–µ –¥–µ—Ñ–∏–Ω–∏—Ä–∞–ª–∏ —Ñ—É–Ω–∫—Ü–∏—è, –∫–æ—è—Ç–æ —Ä–∞–±–æ—Ç–∏ —Å **–Ω—è–∫–æ–π —Ç–∏–ø**, –∫–æ–π—Ç–æ –∏–º–ø–ª–µ–º–µ–Ω—Ç–∏—Ä–∞ `MyTrait`, –±–µ–∑ –¥–∞ –∑–Ω–∞–µ–º –∫–æ–Ω–∫—Ä–µ—Ç–Ω–∏—è `Output` —Ç–∏–ø? –ö–∞–∫–≤–∏ —Å–∞ –≤–∞—Ä–∏–∞–Ω—Ç–∏—Ç–µ –∏ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è—Ç–∞?

<details>
<summary>–ù–∞—Ç–∏—Å–Ω–∏, –∑–∞ –¥–∞ –ø–æ–∫–∞–∂–µ—à –æ—Ç–≥–æ–≤–æ—Ä–∞</summary>

```rust
fn run<T: MyTrait>(x: &T) -> T::Output {
      x.do_stuff()
  }
```

 - –ê–∫–æ –Ω–µ –∑–Ω–∞–µ–º Output, –Ω–µ –º–æ–∂–µ–º –¥–∞ –Ω–∞–ø—Ä–∞–≤–∏–º dyn MyTrait –±–µ–∑ –¥–∞ –≥–æ —Ñ–∏–∫—Å–∏—Ä–∞–º–µ.
 - –ò–ª–∏ –ø–æ–ª–∑–≤–∞–º–µ generic, –∏–ª–∏ —Ñ–∏–∫—Å–∏—Ä–∞–º–µ Output —Ç–∏–ø –≤ —Ç—Ä–µ–π—Ç–∞.

</details>